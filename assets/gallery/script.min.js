(function(e){"use strict";function a(e){if("false"===e)return!1;var a=/(?:\?v=|\/embed\/|\.be\/)([-a-z0-9_]+)/i.exec(e)||/^([-a-z0-9_]+)$/i.exec(e);return!!a&&a[1]}function t(a){e(a.target).closest(".mbr-slider").hasClass("in")&&a.target.playVideo()}function i(a){var t=e(a.target);void 0!==e.fn.masonry&&t.outerFind(".mbr-gallery").each(function(){var a=e(this).find(".mbr-gallery-row").masonry({itemSelector:".mbr-gallery-item:not(.mbr-gallery-item__hided)",percentPosition:!0,horizontalOrder:!0});a.masonry("reloadItems"),a.on("filter",function(){a.masonry("reloadItems"),a.masonry("layout"),e(window).trigger("update.parallax")}.bind(this,a)),a.imagesLoaded().progress(function(){a.masonry("layout")})})}function r(e,a,t,i){e.css({top:t,height:a-2*t-2*i})}function l(e,a,t,i,r){var l=e.find("img");l[0].complete&&l[0].naturalWidth>50&&l[0].naturalHeight>50?n(l,e,a,t,i,r):l.one("load",function(){n(l,e,a,t,i,r)})}function n(e,a,t,i,r,l){var n,o,s=e[0].naturalWidth,d=e[0].naturalHeight;if(i/t>s/d){var c=t-2*l;n=c*s/d}else n=i-2*l;n=n>=s?s:n,o=(t-n*d/s)/2,e.css({width:parseInt(n),height:n*d/s}),a.css("top",o+r)}function o(a,t,i,n,o,s){var d=a.find(".modal-dialog .carousel-item");d.each(function(){(!s&&!e(this)[0].classList.contains("carousel-item-next")&&!e(this)[0].classList.contains("carousel-item-prev")||s&&!e(this)[0].classList.contains("active"))&&(e(this)[0].classList.contains("video-container")?r(e(this),i,n,o):l(e(this),i,t,n,o))})}function s(){var a=0,t=10,i=e(window).width()-2*a,n=e(window).height()-2*a;if(m){var s,d=!1;m.find(".modal-dialog .carousel-item.carousel-item-next, .modal-dialog .carousel-item.carousel-item-prev").length?s=m.find(".modal-dialog .carousel-item.carousel-item-next, .modal-dialog .carousel-item.carousel-item-prev"):(s=m.find(".modal-dialog .carousel-item.active"),d=!0),s[0].classList.contains("video-container")?r(s,n,a,t):l(s,n,i,a,t),clearTimeout(c),c=setTimeout(o,200,m,i,n,a,t,d)}}var d,c,m,u=e("html").hasClass("is-builder");if(!u){var f=document.createElement("script");f.src="https://www.youtube.com/iframe_api";var g=document.getElementsByTagName("script")[0];g.parentNode.insertBefore(f,g);var v=[];e(".carousel-item.video-container img").css("display","none"),window.onYouTubeIframeAPIReady=function(){var i=i||{};i.YTAPIReady||(i.YTAPIReady=!0,jQuery(document).trigger("YTAPIReady")),e(".video-slide").each(function(i){if(e(".video-container").eq(i).append('<div id ="mbr-video-'+i+'" class="mbr-background-video" data-video-num="'+i+'"></div>').append('<div class="item-overlay"></div>'),e(this).attr("data-video-num",i),-1!==e(this).attr("data-video-url").indexOf("vimeo.com")){var r={id:e(this).attr("data-video-url"),width:"100%",height:"100%",loop:!0},l=new Vimeo.Player("mbr-video-"+i,r);l.playVideo=Vimeo.play}else l=new YT.Player("mbr-video-"+i,{height:"100%",width:"100%",videoId:a(e(this).attr("data-video-url")),events:{onReady:t},playerVars:{rel:0}});v.push(l)})}}e(document).on("add.cards",function(a){var t=e(a.target);t.on("click",".mbr-gallery-filter li",function(a){a.preventDefault();var i=e(this).closest("li");i.parent().find("li").removeClass("active"),i.addClass("active");var r=i.closest("section").find(".mbr-gallery-row"),l=e(this)[0].textContent.trim();t.find(".mbr-gallery-item").each(function(a,t){var r=e(this),n=r.attr("data-tags"),o=n.split(","),s=o.map(function(e){return e.trim()});-1!==e.inArray(l,s)||i.hasClass("mbr-gallery-filter-all")?r.removeClass("mbr-gallery-item__hided"):(r.addClass("mbr-gallery-item__hided"),r.css("left","300px"))}),r.closest(".mbr-gallery-row").trigger("filter")})}),u&&e(document).on("changeButtonColor.cards",function(a){var t=e(a.target);if(t.find(".mbr-gallery-filter").length>0&&e(a.target).find(".mbr-gallery-filter").hasClass("gallery-filter-active")){var r=(t.find(".mbr-gallery-filter .mbr-gallery-filter-all").find("a").attr("class")||"").replace(/(^|\s)active(\s|$)/," ").trim();t.find(".mbr-gallery-filter ul li:not(.mbr-gallery-filter-all) a").attr("class",r)}i(a)}),e(document).on("add.cards changeParameter.cards",function(a){var t=e(a.target),r=[];if(t.find(".mbr-gallery-item").each(function(a){var t=(e(this).attr("data-tags")||"").trim().split(",");t.map(function(a){a=a.trim(),-1===e.inArray(a,r)&&r.push(a)})}),t.find(".mbr-gallery-filter").length>0&&e(a.target).find(".mbr-gallery-filter").hasClass("gallery-filter-active")){var l="";t.find(".mbr-gallery-filter ul li:not(.mbr-gallery-filter-all)").remove();var n=t.find(".mbr-gallery-filter .mbr-gallery-filter-all"),o=(n.find("a").attr("class")||"").replace(/(^|\s)active(\s|$)/," ").trim();r.map(function(e){l+='<li><a class="'+o+'" href>'+e+"</a></li>"}),t.find(".mbr-gallery-filter ul").append(l)}i(a)}),e(document).on("change.cards",function(e){i(e)}),e(document).on("lazyload",function(a){i(a),e(window).scrollEnd(function(){i(a)},250)}),e(".mbr-gallery-item").on("click","a",function(e){e.stopPropagation()});var h=e(document).find(".mbr-gallery");h.on("show.bs.modal",function(a){clearTimeout(d),d=setTimeout(function(){var t=e(a.relatedTarget).parent().index(),i=e(a.target).find(".carousel-item").eq(t).find(".mbr-background-video");if(e(a.target).find(".carousel-item .mbr-background-video"),i.length>0){var r=v[+i.attr("data-video-num")];r.playVideo?r.playVideo():r.play()}},500),m=e(a.target),s()}),h.on("slide.bs.carousel",function(a){var t=e(a.target).find(".carousel-item.active .mbr-background-video");if(t.length>0){var i=v[+t.attr("data-video-num")];i.pauseVideo?i.pauseVideo():i.pause()}}),e(window).on("resize load",s),h.on("slid.bs.carousel",function(a){var t=e(a.target).find(".carousel-item.active .mbr-background-video");if(t.length>0){var i=v[+t.attr("data-video-num")];i.playVideo?i.playVideo():i.play()}}),h.on("hide.bs.modal",function(e){v.map(function(e,a){e.pauseVideo?e.pauseVideo():e.pause()}),m=null})})(jQuery);